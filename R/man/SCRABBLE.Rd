% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scrabble.R
\name{scrabble}
\alias{scrabble}
\title{Runs SCRABBLE}
\usage{
scrabble(data, parameter, nIter, error_out_threshold = 1e-05,
  nIter_inner = 5, error_inner_threshold = 1e-05)
}
\arguments{
\item{data}{the input data list. There are two cases SCRABBLE could handle. The first one is that the input
data is a list of two datasets, scRNAseq and bulk RNAseq. The second one is scRNAseq only.}

\item{parameter}{the vector of parameters. The first parameter is the value of alpha in the mathematical model
and the second one is the value of beta in the mathematical model.}

\item{nIter}{the maximum iterations.}

\item{error_out_threshold}{the threshold of the error between the current imputed matrix and the previous one.
Default is 1e-5.}

\item{nIter_inner}{the maximum interations of calculating the sub-optimization problem. Default is 5.}

\item{error_inner_threshold}{the threshold of the error between the current updated matrix and the previous one.
Default is 1e-5.}
}
\value{
A data matrix with the same size of the input scRNAseq data
}
\description{
SCRABBLE imputes drop-out data by optimizing an objective function that consists of three terms.
The first term ensures that imputed values for genes with nonzero expression remain as close to their
original values as possible, thus minimizing unwanted bias towards expressed genes. The second term ensures
the rank of the imputed data matrix to be as small as possible. The rationale is that we only expect a
limited number of distinct cell types in the samples. The third term operates on the bulk RNA-Seq data.
It ensures consistency between the average gene expression of the aggregated imputed data and the
average gene expression of the bulk RNA-Seq data. We developed 58 a convex optimization algorithm to minimize
the objective function.
}
\examples{
# Set up the parameter used in SCRABBLE
parameter <- c(100,2e-7)
nIter <- 100

# Run SCRABLE
result <- scrabble(data,parameter = parameter, nIter = nIter)

}
